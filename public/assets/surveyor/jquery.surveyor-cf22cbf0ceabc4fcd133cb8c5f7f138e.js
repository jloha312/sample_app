// Javascript UI for surveyor
jQuery(document).ready(function(){function a(a){return jQuery.each(a.show,function(){b(this)}),jQuery.each(a.hide,function(){c(this)}),jQuery.each(a.ids,function(a,b){jQuery("#r_"+a+"_question_id").after('<input id="r_'+a+'_id" type="hidden" value="'+b+'" name="r['+a+'][id]"/>')}),jQuery.each(a.remove,function(a,b){jQuery("#r_"+a+'_id[value="'+b+'"]').remove()}),!1}function b(a){group=a.match("^g_")?!0:!1,group?jQuery("#"+a).removeClass("g_hidden"):jQuery("#"+a).removeClass("q_hidden")}function c(a){group=a.match("^g_")?!0:!1,group?jQuery("#"+a).addClass("g_hidden"):jQuery("#"+a).addClass("q_hidden")}function d(a){$.blockUI.defaults.overlayCSS.opacity=0,$.blockUI.defaults.message=null,$.blockUI.defaults.fadeIn=0,$.blockUI.defaults.fadeOut=0,$.each(a,function(){$(this).block()})}function e(a){$.each(a,function(){$(this).unblock()})}jQuery("li.date input").change(function(){if($(this).data("dateinput")){var a=$(this).data("dateinput").getValue();this.value=a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()+" 00:00:00 UTC"}}),jQuery("form#survey_form input, form#survey_form select, form#survey_form textarea").change(function(){var b=[$('[type="submit"]').parent(),$('[name="'+this.name+'"]').closest("li")];d(b),question_data=$(this).parents('fieldset[id^="q_"],tr[id^="q_"]').find("input, select, textarea").add($("form#survey_form input[name='authenticity_token']")).serialize(),$.ajax({type:"PUT",url:$(this).parents("form#survey_form").attr("action"),data:question_data,dataType:"json",success:function(c){e(b),a(c)},error:function(a,c,d){e(b)}})}),jQuery("#dependents").remove(),$("input.exclusive:checked").parents('fieldset[id^="q_"]').find(":checkbox").not(".exclusive").attr("checked",!1).attr("disabled",!0),$("input.exclusive:checkbox").click(function(){var a=$(this),b=a.parents('fieldset[id^="q_"]').find(":checkbox").not(".exclusive");a.is(":checked")?b.attr("checked",!1).attr("disabled",!0):b.attr("disabled",!1)}),$("li.date input").dateinput({format:"dd mmm yyyy"})})